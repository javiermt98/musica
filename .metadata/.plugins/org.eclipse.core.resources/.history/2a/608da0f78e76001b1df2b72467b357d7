package ejercicios;

import static com.mongodb.client.model.Filters.regex;

import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;

import org.bson.Document;

import com.mongodb.client.MongoClient;
import com.mongodb.client.MongoClients;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;

public class Ejercicio05_MongoDB {
	public static void main(String[]args) {
		MongoClient mongoClient = MongoClients.create("mongodb://localhost/27017");
		MongoDatabase database = mongoClient.getDatabase("musica");
		MongoCollection<Document> collectiongrupo = database.getCollection("grupo");
		MongoCollection<Document> collectioncompany = database.getCollection("company");
		
		//************************************************************************************************
		//APARTADO A - INSERTAR A UN GRUPO EXISTENTE, UN DISCO CON UNA CANCION INTRODUCIDOS POR EL USUARIO
		//************************************************************************************************
		
		System.out.println("\n******************* Apartado A *******************");
		
		System.out.println("************ CREANDO UN DISCO ************");
		Scanner sc = new Scanner(System.in);
		System.out.print("Nombre: ");
		String nombre_d = sc.nextLine();
		System.out.print("Fecha (YYYY-MM-AA): ");
		String fecha = sc.nextLine();
		
		System.out.println("************ CREANDO UNA CANCION ************");
		Scanner c = new Scanner(System.in);
		System.out.print("Nombre: ");
		String nombre_c = c.nextLine();
		System.out.print("Fecha (YYYY-MM-AA): ");
		Double duracion = c.nextDouble();
		
		System.out.println("************ GRUPO Y DISCOGRAFICA ************");
		Scanner d = new Scanner(System.in);
		System.out.print("Grupo al que pertenecerá: ");
		String g = d.nextLine();
		System.out.print("Discografica: ");
		String disc = d.nextLine();

		

		Scanner c = new Scanner(System.in);
		System.out.println("Companyia: ");
		String com = a.nextLine();
		List<Document>documentos = new ArrayList<Document>();
		collectioncompany.find(regex("nombre_company",com)).into(documentos);
		
		List<Document>grupos = new ArrayList<Document>();
		collectiongrupo.find().into(grupos);
		int cod_comp=-1;
		for(Document companyia: documentos) {
			cod_comp = companyia.getInteger("cod_company");
		}
		for(Document grupo: grupos) {
			List<Document> discos = (List<Document>) grupo.get("disco");
			for(Document disc: discos) {
				if(disc.getInteger("cod_company") == cod_comp) {
					System.out.println(disc.get("nombre_disco")+": "+disc.get("fecha_disco"));
				}
			}
		}
	
	
	
	}

}
